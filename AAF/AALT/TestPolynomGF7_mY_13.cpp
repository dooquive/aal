/*
    MPEI Algebraic Abstractions Library,
    2007-2011,
    Moscow Power Engineering Institute

        This file contains tests of the following classes:

*/
#include <iostream>
#include "./CppUnitLite/TestHarness.h"
#include "./AAF/AAL/PolynomGF7.h"
#include "./AAF/AAL/PolynomGF7_m_14.h"
#include "./AAF/AAL/PolynomGF7_m_2.h"
#include "./AAF/AAL/PolynomGF7_mY_13.h"
#include "./AAF/AAL/Matrix.h"
#include "./AAF/AAL/Integer.h"
#include "./AAF/AAL/DecompositionManager.h"
#include "./AAF/AAL/FactorizationAlgorithms.h"
#include <set>
using namespace AAL;

/*
	пїЅпїЅпїЅпїЅпїЅпїЅпїЅпїЅпїЅпїЅпїЅпїЅ пїЅпїЅпїЅпїЅпїЅпїЅ PolynomGF2_mY_7
*/

TEST(PolynomGF7_mY_13, EmptyConstructor)
{
	PolynomGF7_mY_13 p;
	CHECK(p.isZero());
}

TEST(PolynomGF7_mY_13, CopyConstructor)
{
	PolynomGF7_mY_13 p("111", "000", "1010", "1100", "000", "1010","000","000","000","000","000","111", "000", "1010", "1100", "000", "1010","000","000","000","000","000","000","000","000","000","");
    PolynomGF7_mY_13 pp(p);
	CHECK(p==pp);
}

TEST(PolynomGF7_mY_13, StringConstructor)
{
	PolynomGF7_mY_13 p1("000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"), p2("","","","","","","","","","","","","","","","","","","","","","","","","","",""), p3("100","100","000","010","100","000","010","100","000","010","000","100","100","000","010","100","000","010","100","000","010","000","100","000","010","000","1101");
    PolynomGF7_m_2 a0("100","100","");
    PolynomGF7 module("1101");
	CHECK(p1.isZero(module));
	CHECK(p2.isZero());
	CHECK(p3.getA0() == a0);
}
TEST(PolynomGF7_mY_13, Deg)
{
	PolynomGF7_mY_13 p1("000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"), p2("000","000","000","100","000","000","000","000","000","000","000","000","000","000","100","000","000","000","000","000","000","000","000","000","000","000","1101"), p3("100","100","000","010","100","000","010","100","000","010","000","100","100","000","010","100","000","010","100","000","010","00","100","00","010","000","1101");
	CHECK(p1.deg() == -1);
	CHECK(p2.deg() == 7);
	CHECK(p3.deg() == 12);
}

TEST(PolynomGF7_mY_13, Add)
{
        PolynomGF7_mY_13 a("101","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1101"),b("01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","01","1101");
        PolynomGF7_mY_13 d("111","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","010","1101"),c,c2,c1,c3;
//        PolynomGF2_m_4 a1("11111","11111","11111","11111","101001"),b1("11110","11110","11110","11110","101001");
//        PolynomGF2_mY_7 d1("00001","00001","00001","00001","00001","00001","00001","101001");
//        c1 = a1 + b1;
        c2 = a + b;
        CHECK(c2 == d)
//        CHECK(c3.Add(a1,b1) == d1);
        CHECK(c.Add(a,b) == d);
//        CHECK(c1 == d1)
//        b += a;
//        CHECK(b == d);
        CHECK(a + b == b + a);
        CHECK((a + b) + c == a + (b + c));

}

TEST(PolynomGF7_mY_13, Mul)
{
//        PolynomGF7_m_14 a("001","010","011","100","100","100","001","010","011","100","100","100","011","100","1101"),b("000","100","000","000","000","000","000","100","000","000","000","000","000","000","1101");
        PolynomGF7_mY_13 d("000","001","010","011","100","100","100","000","000","000","000","000","001","010","011","100","100","100","000","000","000","000","000","000","000","000","1101"),c,c1;
        PolynomGF7_mY_13 d1("300","000","100","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
        PolynomGF7_m_14  a1("1","0","0","0","0","0","0","0","0","0","0","0","0","0","1101"),b1("300","0","100","0","0","0","0","0","0","0","0","0","0","0","1101");
//        PolynomGF3_m_9 a1("001","010","011","100","220001"),b1("000","000","010","000","220001");
//        PolynomGF3_mY_9 d1("000","00","110","001","111","01","0","220001"),c1;
//        PolynomGF3_m_9 a2("001","010","011","100","220001"),b2("000","100","010","000","220001");
//        PolynomGF3_mY_9 d2("000","001","100","010","011","01","0","220001"),c2;
        CHECK(c.Mul(b1,a1) == d1);
        CHECK(c.Mul(a1,b1) == c1.Mul(b1,a1));
//        CHECK(c2.Mul(a2,b2) == d2);

}
TEST(PolynomGF7_mY_13, FullMul)
{
        PolynomGF7_mY_13 a("300","000","100","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),b("100","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),c1;
        PolynomGF7_mY_13 d("300","000","100","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),c;
//        PolynomGF3_m_9 a1("001","010","011","100","220001"),b1("000","000","010","000","220001");
//        PolynomGF3_mY_9 d1("000","00","110","001","111","01","0","220001"),c1;
//        PolynomGF3_m_9 a2("001","010","011","100","220001"),b2("000","100","010","000","220001");
//        PolynomGF3_mY_9 d2("000","001","100","010","011","01","0","220001"),c2;
        CHECK(c.FullMul(a,b) == d);
        CHECK(c1.FullMul(a,b) == c.FullMul(b,a));
//        CHECK(c2.Mul(a2,b2) == d2);

}

TEST(PolynomGF7_mY_13, MonomialMul)
{
        PolynomGF7_mY_13 a("100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),c;
        PolynomGF7_m_14 b("200","100","000","000","000","000","000","000","000","000","000","000","000","000","1101");
        PolynomGF7_mY_13 d("600","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
        CHECK(c.MonomialMul(a,b) == d);
}
TEST(PolynomGF7_mY_13, NormalMonomialMul)
{
        try
	{
                PolynomGF7_mY_13 a("100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),c;
                PolynomGF7_mY_13 d("000","000","100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
                CHECK(c.NormalMonomialMul(a,1) == d);
                PolynomGF7_mY_13 a1("100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),c1;
                PolynomGF7_mY_13 d1("000","000","000","000","100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
                CHECK(c1.NormalMonomialMul(a1,2) == d1);
	}
	catch(Exception *E)
	{
		CHECK(false);
	}
}
TEST(PolynomGF7_mY_13, Div)
{
        try
	{
                PolynomGF7 f("1101");
                PolynomGF7_mY_13 t,a("100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),c,r;
                PolynomGF7_mY_13 b("600","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
                PolynomGF7_mY_13 q("200","100","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
                PolynomGF7_mY_13 remainder("000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
                //;
                CHECK(c.Div(b,a,f,&r) == q);
                CHECK(remainder == r);
        }
	catch(Exception *E)
	{
		CHECK(false);
	}
}
TEST(PolynomGF7_mY_13, GCD)
{
        try
	{
                PolynomGF7 f("1101");
                PolynomGF7_mY_13 t,a("100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101"),c,r;
                PolynomGF7_mY_13 b("600","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
                PolynomGF7_mY_13 q("100","300","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","000","1101");
                CHECK(c.GCD(b,a,f) == q);
        }
	catch(Exception *E)
	{
		CHECK(false);
	}
}


